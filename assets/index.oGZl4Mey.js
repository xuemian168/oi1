var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i,r=(e,t,n)=>new Promise((i,s)=>{var a=e=>{try{r(n.next(e))}catch(t){s(t)}},o=e=>{try{r(n.throw(e))}catch(t){s(t)}},r=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,o);r((n=n.apply(e,t)).next())});!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const l={app:{title:"oi1 视觉加密工具",subtitle:"基于 O0Il 相似字符的视觉混淆加密"},ui:{encrypt:"加密",decrypt:"解密",copy:"复制",paste:"粘贴",clear:"清空",help:"算法说明",demo:"演示",expand:"展开",collapse:"收起",export:"导出",import:"导入",settings:"设置"},encoder:{title:"加密器",subtitle:"将文本转换为 O0Il 字符",input:{label:"原文输入",placeholder:"请输入要加密的文本..."},output:{label:"密文输出",placeholder:"加密结果将在这里显示..."}},decoder:{title:"解密器",subtitle:"将 O0Il 字符还原为文本",input:{label:"密文输入",placeholder:"请输入由 O0Il 组成的密文..."},output:{label:"原文输出",placeholder:"解密结果将在这里显示..."}},validation:{valid:"密文格式正确",invalid:"密文格式错误",empty:"输入不能为空",invalidChar:"包含无效字符",invalidLength:"长度不正确"},demo:{title:"算法原理演示",toggle:"切换演示",encoding:"编码过程",decoding:"解码过程",step:"步骤",input:"输入",output:"输出",technical:"技术详情"},help:{title:"oi1 算法原理",similarity:{title:"视觉相似性对比",pairs:[{char1:"O",char2:"0",desc:"大写O ↔ 数字零"},{char1:"I",char2:"l",desc:"大写I ↔ 小写L"}]},mapping:{title:"字符映射表",subtitle:"算法将文本转为二进制，每2位二进制映射为一个字符：",table:[{binary:"00",char:"O",desc:"大写字母 O"},{binary:"01",char:"0",desc:"数字零"},{binary:"10",char:"I",desc:"大写字母 I"},{binary:"11",char:"l",desc:"小写字母 L"}]},process:{title:"加密流程",steps:[{number:"1",title:"文本输入",desc:"输入任意UTF-8文本"},{number:"2",title:"UTF-8编码",desc:"转换为字节数组"},{number:"3",title:"二进制转换",desc:"每字节转为8位二进制"},{number:"4",title:"字符映射",desc:"每2位二进制映射为O0Il字符"},{number:"✓",title:"密文输出",desc:"仅含O0Il的视觉混淆文本"}]},example:{title:"加密示例",subtitle:'示例：加密 "Hi"',steps:[{label:"原文：",value:'"Hi"'},{label:"UTF-8：",value:"[72, 105]"},{label:"二进制：",value:"01001000 01101001"},{label:"分组：",value:"01|00|10|00 01|10|10|01"},{label:"映射：",value:"0|O|I|O 0|I|I|0"},{label:"密文：",value:"0OIO0II0"}]},visual:{title:"视觉效果对比",normal:"普通字体：0OIO0II0",mono:"等宽字体：0OIO0II0"},security:{title:"安全特性",features:[{icon:"🔒",title:"本地处理",desc:"加密过程完全在浏览器本地执行，不上传任何数据。支持离线使用，保护隐私安全。"},{icon:"👁️",title:"视觉混淆",desc:"通过视觉相似字符隐藏真实内容，适用于需要视觉隐蔽的场景。"},{icon:"🔄",title:"完全可逆",desc:"标准模式下保证100%可逆，无信息损失。"}],warning:"注意： 本工具主要用于视觉混淆，不提供加密安全保护。如需真正的安全加密，请使用专业的加密算法。"},tips:{title:"使用技巧",items:[{icon:"💡",title:"快捷键支持",desc:"Ctrl+Enter 执行加密/解密，Ctrl+K 清空输入"},{icon:"🎨",title:"字体优化",desc:"密文区域使用等宽字体增强视觉混淆效果"},{icon:"📊",title:"实时验证",desc:"输入密文时会自动验证格式并显示状态"},{icon:"🔄",title:"可逆性保证",desc:"标准模式下加密解密完全可逆，无信息丢失"}]},specs:{title:"技术规格",items:[{label:"字符集",value:"O (大写O)、0 (数字零)、I (大写I)、l (小写L)"},{label:"编码方式",value:"UTF-8 → 二进制 → 2位分组映射"},{label:"压缩比",value:"约 4:1 (1字节 → 4字符)"},{label:"支持语言",value:"所有UTF-8字符，包括中文、英文、符号等"},{label:"浏览器支持",value:"现代浏览器，支持ES6+"}]}},stats:{title:"统计信息",originalLength:"原文长度",cipherLength:"密文长度",compressionRatio:"压缩比",charDistribution:"字符分布",quality:"密文质量"},messages:{copySuccess:"已复制到剪贴板",copyError:"复制失败",encodeSuccess:"加密完成",decodeSuccess:"解密完成",encodeError:"加密失败",decodeError:"解密失败",invalidInput:"输入无效",pasteSuccess:"已粘贴",pasteError:"粘贴失败",clearSuccess:"已清空"},errors:{notString:"输入必须是字符串",emptyInput:"输入不能为空",invalidChar:"包含无效字符 '{char}' (位置: {position})",encodingError:"加密过程中发生错误: {error}",decodingError:"解码过程中发生错误: {error}",validationError:"密文格式错误: {error}"},footer:{github:"GitHub",linkedin:"领英",email:"邮箱",copyright:"© 2025",rights:"保留所有权利"}},c={app:{title:"oi1 Visual Encoder",subtitle:"Visual Obfuscation Encryption Based on O0Il Similar Characters"},ui:{encrypt:"Encrypt",decrypt:"Decrypt",copy:"Copy",paste:"Paste",clear:"Clear",help:"Algorithm Guide",demo:"Demo",expand:"Expand",collapse:"Collapse",export:"Export",import:"Import",settings:"Settings"},encoder:{title:"Encoder",subtitle:"Convert text to O0Il characters",input:{label:"Plain Text Input",placeholder:"Enter text to encrypt..."},output:{label:"Cipher Text Output",placeholder:"Encryption result will appear here..."}},decoder:{title:"Decoder",subtitle:"Convert O0Il characters back to text",input:{label:"Cipher Text Input",placeholder:"Enter O0Il cipher text..."},output:{label:"Plain Text Output",placeholder:"Decryption result will appear here..."}},validation:{valid:"Cipher format is valid",invalid:"Cipher format is invalid",empty:"Input cannot be empty",invalidChar:"Contains invalid characters",invalidLength:"Incorrect length"},demo:{title:"Algorithm Demonstration",toggle:"Toggle Demo",encoding:"Encoding Process",decoding:"Decoding Process",step:"Step",input:"Input",output:"Output",technical:"Technical Details"},help:{title:"oi1 Algorithm Principles",similarity:{title:"Visual Similarity Comparison",pairs:[{char1:"O",char2:"0",desc:"Uppercase O ↔ Digit Zero"},{char1:"I",char2:"l",desc:"Uppercase I ↔ Lowercase L"}]},mapping:{title:"Character Mapping",subtitle:"The algorithm converts text to binary, mapping each 2-bit binary to a character:",table:[{binary:"00",char:"O",desc:"Uppercase Letter O"},{binary:"01",char:"0",desc:"Digit Zero"},{binary:"10",char:"I",desc:"Uppercase Letter I"},{binary:"11",char:"l",desc:"Lowercase Letter L"}]},process:{title:"Encryption Process",steps:[{number:"1",title:"Text Input",desc:"Input any UTF-8 text"},{number:"2",title:"UTF-8 Encoding",desc:"Convert to byte array"},{number:"3",title:"Binary Conversion",desc:"Each byte to 8-bit binary"},{number:"4",title:"Character Mapping",desc:"Each 2-bit binary maps to O0Il character"},{number:"✓",title:"Cipher Output",desc:"Visual obfuscation text with O0Il only"}]},example:{title:"Encryption Example",subtitle:'Example: Encrypt "Hi"',steps:[{label:"Original:",value:'"Hi"'},{label:"UTF-8:",value:"[72, 105]"},{label:"Binary:",value:"01001000 01101001"},{label:"Grouped:",value:"01|00|10|00 01|10|10|01"},{label:"Mapped:",value:"0|O|I|O 0|I|I|0"},{label:"Cipher:",value:"0OIO0II0"}]},visual:{title:"Visual Effect Comparison",normal:"Normal Font: 0OIO0II0",mono:"Monospace Font: 0OIO0II0"},security:{title:"Security Features",features:[{icon:"🔒",title:"Local Processing",desc:"The encryption process executes entirely in the browser locally, without uploading any data. Supports offline use and protects privacy."},{icon:"👁️",title:"Visual Obfuscation",desc:"Hides real content through visually similar characters, suitable for scenarios requiring visual concealment."},{icon:"🔄",title:"Fully Reversible",desc:"Standard mode guarantees 100% reversibility with no information loss."}],warning:"Note: This tool is primarily for visual obfuscation and does not provide encryption security protection. For real security encryption, please use professional encryption algorithms."},tips:{title:"Usage Tips",items:[{icon:"💡",title:"Keyboard Shortcuts",desc:"Ctrl+Enter to encrypt/decrypt, Ctrl+K to clear input"},{icon:"🎨",title:"Font Optimization",desc:"Cipher area uses monospace font to enhance visual obfuscation"},{icon:"📊",title:"Real-time Validation",desc:"Automatically validates format and shows status when inputting cipher"},{icon:"🔄",title:"Reversibility Guarantee",desc:"Standard mode ensures completely reversible encryption/decryption with no information loss"}]},specs:{title:"Technical Specifications",items:[{label:"Character Set",value:"O (Uppercase O), 0 (Digit Zero), I (Uppercase I), l (Lowercase L)"},{label:"Encoding Method",value:"UTF-8 → Binary → 2-bit Group Mapping"},{label:"Compression Ratio",value:"Approx 4:1 (1 byte → 4 characters)"},{label:"Language Support",value:"All UTF-8 characters including Chinese, English, symbols, etc."},{label:"Browser Support",value:"Modern browsers supporting ES6+"}]}},stats:{title:"Statistics",originalLength:"Original Length",cipherLength:"Cipher Length",compressionRatio:"Compression Ratio",charDistribution:"Character Distribution",quality:"Cipher Quality"},messages:{copySuccess:"Copied to clipboard",copyError:"Copy failed",encodeSuccess:"Encryption completed",decodeSuccess:"Decryption completed",encodeError:"Encryption failed",decodeError:"Decryption failed",invalidInput:"Invalid input",pasteSuccess:"Pasted successfully",pasteError:"Paste failed",clearSuccess:"Cleared"},errors:{notString:"Input must be a string",emptyInput:"Input cannot be empty",invalidChar:"Contains invalid character '{char}' (position: {position})",encodingError:"Error during encoding: {error}",decodingError:"Error during decoding: {error}",validationError:"Cipher format error: {error}"},footer:{github:"GitHub",linkedin:"LinkedIn",email:"Email",copyright:"© 2024",rights:"All rights reserved"}};const d=new class{constructor(){this.languages={"zh-CN":l,"en-US":c},this.currentLang=this.detectLanguage(),this.currentMessages=this.languages[this.currentLang],this.applyLanguage()}detectLanguage(){const e=localStorage.getItem("oi1-language");if(e&&this.languages[e])return e;const t=navigator.language||navigator.userLanguage;return t.startsWith("zh")?"zh-CN":t.startsWith("en")?"en-US":"zh-CN"}t(e,t={}){const n=e.split(".");let i=this.currentMessages;for(const s of n){if(!i||"object"!=typeof i||!(s in i))return console.warn(`Translation key not found: ${e}`),e;i=i[s]}return"string"!=typeof i?(console.warn(`Translation key should resolve to string: ${e}`),e):this.interpolate(i,t)}interpolate(e,t){return e.replace(/{(\w+)}/g,(e,n)=>t.hasOwnProperty(n)?t[n]:e)}setLanguage(e){this.languages[e]?(this.currentLang=e,this.currentMessages=this.languages[e],localStorage.setItem("oi1-language",e),document.documentElement.lang=e,this.applyLanguage(),this.dispatchLanguageChangeEvent()):console.error(`Unsupported language: ${e}`)}getCurrentLanguage(){return this.currentLang}getAvailableLanguages(){return{"zh-CN":"中文","en-US":"English"}}applyLanguage(){document.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n");t&&(e.textContent=this.t(t))});document.querySelectorAll("[data-i18n-placeholder]").forEach(e=>{const t=e.getAttribute("data-i18n-placeholder");t&&(e.placeholder=this.t(t))});document.querySelectorAll("[data-i18n-title]").forEach(e=>{const t=e.getAttribute("data-i18n-title");t&&(e.title=this.t(t))}),document.title=this.t("app.title")}dispatchLanguageChangeEvent(){const e=new CustomEvent("languageChange",{detail:{language:this.currentLang,messages:this.currentMessages}});window.dispatchEvent(e)}formatNumber(e,t={}){const n="zh-CN"===this.currentLang?"zh-CN":"en-US";return new Intl.NumberFormat(n,t).format(e)}formatDate(e,t={}){const n="zh-CN"===this.currentLang?"zh-CN":"en-US";return new Intl.DateTimeFormat(n,t).format(e)}formatRelativeTime(e,t=new Date){const n="zh-CN"===this.currentLang?"zh-CN":"en-US",i=new Intl.RelativeTimeFormat(n,{numeric:"auto"}),s=Math.round((e-t)/1e3),a=Math.round(s/60),o=Math.round(a/60),r=Math.round(o/24);return Math.abs(s)<60?i.format(s,"second"):Math.abs(a)<60?i.format(a,"minute"):Math.abs(o)<24?i.format(o,"hour"):i.format(r,"day")}validateTranslations(){const e=[],t=Object.keys(this.languages),n=this._getFlatKeys(this.languages[t[0]]);for(let i=1;i<t.length;i++){const s=this._getFlatKeys(this.languages[t[i]]),a=n.filter(e=>!s.includes(e));a.length>0&&e.push({language:t[i],type:"missing_keys",keys:a});const o=s.filter(e=>!n.includes(e));o.length>0&&e.push({language:t[i],type:"extra_keys",keys:o})}return{isValid:0===e.length,issues:e}}_getFlatKeys(e,t=""){const n=[];for(const[i,s]of Object.entries(e)){const e=t?`${t}.${i}`:i;"object"!=typeof s||null===s||Array.isArray(s)?n.push(e):n.push(...this._getFlatKeys(s,e))}return n}},h={"00":"O","01":"0",10:"I",11:"l"},p={O:"00",0:"01",I:"10",l:"11"},u=new Set(["O","0","I","l"]);class g{encode(e){if("string"!=typeof e)throw new Error("输入必须是字符串");if(!e)return"";try{const t=(new TextEncoder).encode(e);let n="";for(const e of t)n+=e.toString(2).padStart(8,"0");return this._binaryToChars(n)}catch(t){throw new Error(`加密过程中发生错误: ${t.message}`)}}_binaryToChars(e){const t=(2-e.length%2)%2,n=e+"0".repeat(t);let i="";for(let s=0;s<n.length;s+=2){const e=n.substring(s,s+2);i+=h[e]}return i}getEncodingStats(e,t){const n=(new TextEncoder).encode(e);return{originalLength:e.length,originalBytes:n.length,cipherLength:t.length,compressionRatio:t.length/e.length,bytesRatio:t.length/n.length,charDistribution:this._getCharDistribution(t)}}_getCharDistribution(e){const t={O:0,0:0,I:0,l:0};for(const s of e)t.hasOwnProperty(s)&&t[s]++;const n=e.length,i={};for(const[s,a]of Object.entries(t))i[s]=n>0?(a/n*100).toFixed(1):0;return{counts:t,percentages:i,total:n}}}class m{decode(e){if("string"!=typeof e)throw new Error("输入必须是字符串");if(!e)return"";const t=this.validateCiphertext(e);if(!t.isValid)throw new Error(`密文格式错误: ${t.error}`);try{let t="";for(const n of e)t+=p[n];const i=[];for(let e=0;e<t.length;e+=8){const n=t.substring(e,e+8);8===n.length&&i.push(parseInt(n,2))}const s=new Uint8Array(i),a=new TextDecoder("utf-8",{fatal:!0});try{return a.decode(s)}catch(n){const e=i.map(e=>`${e}(0x${e.toString(16)})`).join(", ");throw new Error(`UTF-8解码失败，字节序列可能无效: [${e}]. 原始错误: ${n.message}`)}}catch(i){throw new Error(`解码过程中发生错误: ${i.message}`)}}validateCiphertext(e){if(!e||"string"!=typeof e)return{isValid:!1,error:"密文不能为空"};for(let t=0;t<e.length;t++){const n=e[t];if(!u.has(n))return{isValid:!1,error:`包含无效字符 '${n}' (位置: ${t+1})`}}return{isValid:!0,error:null}}getCiphertextQuality(e){const t=this.validateCiphertext(e);if(!t.isValid)return{quality:0,issues:[t.error],recommendations:["请检查密文格式"]};const n=this._getCharDistribution(e),i=[],s=[];let a=100;const o=Object.values(n.percentages).map(e=>parseFloat(e));return this._calculateVariance(o)>300&&(a-=20,i.push("字符分布不均匀"),s.push("考虑使用混合模式提高分布均匀性")),e.length<8&&(a-=10,i.push("密文长度较短")),this._hasObviousPatterns(e)&&(a-=15,i.push("存在明显的重复模式"),s.push("原文可能包含重复内容")),{quality:Math.max(0,a),distribution:n,issues:i,recommendations:s}}_calculateVariance(e){const t=e.reduce((e,t)=>e+t,0)/e.length;return e.reduce((e,n)=>e+Math.pow(n-t,2),0)/e.length}_hasObviousPatterns(e){for(let n=0;n<e.length-3;n++)if(e[n]===e[n+1]&&e[n]===e[n+2]&&e[n]===e[n+3])return!0;let t=0;for(let n=0;n<e.length-1;n++)n>0&&e[n]===e[n-2]&&e[n]!==e[n-1]&&t++;return t>.3*e.length}_getCharDistribution(e){const t={O:0,0:0,I:0,l:0};for(const s of e)t.hasOwnProperty(s)&&t[s]++;const n=e.length,i={};for(const[s,a]of Object.entries(t))i[s]=n>0?(a/n*100).toFixed(1):0;return{counts:t,percentages:i,total:n}}}class y{static generateEncodingDemo(e){if(!e)return[];const t=[];try{const n=(new TextEncoder).encode(e);t.push({step:1,title:"文本转UTF-8字节",description:"将输入文本转换为UTF-8编码的字节数组",input:e,output:Array.from(n).map(e=>e.toString()).join(", "),technical:`字节数组: [${Array.from(n).join(", ")}]`});let i="";const s=[];for(const e of n){const t=e.toString(2).padStart(8,"0");s.push(t),i+=t}t.push({step:2,title:"字节转二进制",description:"将每个字节转换为8位二进制数",input:Array.from(n).join(", "),output:s.join(" "),technical:`完整二进制串: ${i}`});const a=[];for(let e=0;e<i.length;e+=2)a.push(i.substring(e,e+2));t.push({step:3,title:"二进制分组",description:"将二进制串按每2位分组",input:i,output:a.join(" | "),technical:`分组数量: ${a.length}`});const o=[];for(const e of a){const t=h[e]||"?";o.push(`${e}→${t}`)}const r=a.map(e=>h[e]||"?").join("");return t.push({step:4,title:"映射到O0Il字符",description:"将每个2位二进制组映射到对应的字符",input:a.join(" "),output:o.join(" "),technical:`最终密文: ${r}`}),t}catch(n){return[{step:0,title:"错误",description:"演示生成失败",input:e,output:n.message,technical:""}]}}static generateDecodingDemo(e){if(!e)return[];const t=[],n=new m;try{const i=n.validateCiphertext(e);if(!i.isValid)return[{step:0,title:"验证失败",description:"密文格式不正确",input:e,output:i.error,technical:""}];const s=[];let a="";for(const t of e){const e=p[t];s.push(`${t}→${e}`),a+=e}t.push({step:1,title:"字符反映射",description:"将O0Il字符反映射为二进制",input:e,output:s.join(" "),technical:`完整二进制串: ${a}`});const o=[],r=[];for(let e=0;e<a.length;e+=8){const t=a.substring(e,e+8);if(8===t.length){const e=parseInt(t,2);o.push(`${t}(${e})`),r.push(e)}}t.push({step:2,title:"重组为字节",description:"将二进制串按8位分组转换为字节",input:a,output:o.join(" "),technical:`字节数组: [${r.join(", ")}]`});const l=new Uint8Array(r),c=new TextDecoder("utf-8").decode(l);return t.push({step:3,title:"UTF-8解码",description:"将字节数组解码为UTF-8文本",input:`[${r.join(", ")}]`,output:c,technical:`解码成功，共${c.length}个字符`}),t}catch(i){return[{step:0,title:"错误",description:"演示生成失败",input:e,output:i.message,technical:""}]}}}class v{constructor(){this.isModernAPI=this.checkModernAPISupport()}checkModernAPISupport(){return"undefined"!=typeof navigator&&navigator.clipboard&&"function"==typeof navigator.clipboard.writeText&&"function"==typeof navigator.clipboard.readText}copy(e){return r(this,null,function*(){if("string"!=typeof e)throw new Error("Text must be a string");return this.isModernAPI?yield this.copyModern(e):yield this.copyLegacy(e)})}paste(){return r(this,null,function*(){return this.isModernAPI?yield this.pasteModern():yield this.pasteLegacy()})}copyModern(e){return r(this,null,function*(){try{yield navigator.clipboard.writeText(e)}catch(t){return console.warn("Modern clipboard API failed, falling back to legacy method:",t),yield this.copyLegacy(e)}})}pasteModern(){return r(this,null,function*(){try{return yield navigator.clipboard.readText()}catch(e){return console.warn("Modern clipboard API failed, falling back to legacy method:",e),yield this.pasteLegacy()}})}copyLegacy(e){return r(this,null,function*(){return new Promise((t,n)=>{try{const i=document.createElement("textarea");i.value=e,i.style.position="fixed",i.style.left="-999999px",i.style.top="-999999px",i.style.opacity="0",i.style.pointerEvents="none",document.body.appendChild(i),i.focus(),i.select(),i.setSelectionRange(0,e.length);const s=document.execCommand("copy");document.body.removeChild(i),s?t():n(new Error("Copy command was unsuccessful"))}catch(i){n(new Error(`Legacy copy failed: ${i.message}`))}})})}pasteLegacy(){return r(this,null,function*(){return new Promise((e,t)=>{t(new Error("Legacy paste not supported. Please use Ctrl+V manually."))})})}checkPermission(){return r(this,null,function*(){if(!this.isModernAPI)return"legacy";try{return(yield navigator.permissions.query({name:"clipboard-read"})).state}catch(e){return console.warn("Cannot check clipboard permission:",e),"unknown"}})}copyRich(e,t){return r(this,null,function*(){if(!this.isModernAPI)return yield this.copyLegacy(t);try{const n=new ClipboardItem({"text/html":new Blob([e],{type:"text/html"}),"text/plain":new Blob([t],{type:"text/plain"})});yield navigator.clipboard.write([n])}catch(n){return console.warn("Rich text copy failed, falling back to plain text:",n),yield this.copyModern(t)}})}copyImage(e){return r(this,null,function*(){if(!this.isModernAPI)throw new Error("Image copying is not supported in legacy browsers");try{const t=new ClipboardItem({[e.type]:e});yield navigator.clipboard.write([t])}catch(t){throw new Error(`Image copy failed: ${t.message}`)}})}getSupportedTypes(){return r(this,null,function*(){if(!this.isModernAPI)return["text/plain"];try{const e=yield navigator.clipboard.read();return e.length>0?e[0].types:[]}catch(e){return console.warn("Cannot get clipboard types:",e),["text/plain"]}})}onClipboardChange(e){let t="",n=!0;const i=()=>r(this,null,function*(){if(n){try{const n=yield this.paste();n!==t&&(t=n,e(n))}catch(s){}setTimeout(i,1e3)}});return i(),()=>{n=!1}}getStatus(){return r(this,null,function*(){const e={isSupported:this.isModernAPI,permission:yield this.checkPermission(),supportedTypes:yield this.getSupportedTypes(),canRead:!1,canWrite:!1};try{yield this.copy("test"),e.canWrite=!0}catch(t){e.canWrite=!1}try{yield this.paste(),e.canRead=!0}catch(t){e.canRead=!1}return e})}}new v;class b{constructor(){this.container=null,this.isInitialized=!1,this.currentDemo=null,this.animationSpeed=1e3}init(e){return r(this,null,function*(){this.isInitialized||(this.container=e,this.createDemoStructure(),this.bindEvents(),this.isInitialized=!0)})}createDemoStructure(){this.container&&(this.container.innerHTML='\n            <div class="demo-controls">\n                <div class="demo-tabs">\n                    <button class="demo-tab active" data-tab="encoding" data-i18n="demo.encoding">编码过程</button>\n                    <button class="demo-tab" data-tab="decoding" data-i18n="demo.decoding">解码过程</button>\n                </div>\n            </div>\n            \n            <div class="demo-content-area">\n                <div id="encodingDemo" class="demo-panel active">\n                    <div class="demo-steps" id="encodingSteps"></div>\n                </div>\n                \n                <div id="decodingDemo" class="demo-panel">\n                    <div class="demo-steps" id="decodingSteps"></div>\n                </div>\n            </div>\n            \n            <div class="demo-footer">\n                <div class="demo-status" id="demoStatus"></div>\n            </div>\n        ',d.applyLanguage())}bindEvents(){if(!this.container)return;this.container.querySelectorAll(".demo-tab").forEach(e=>{e.addEventListener("click",e=>{this.switchTab(e.target.dataset.tab)})})}switchTab(e){if(!this.container)return;this.container.querySelectorAll(".demo-tab").forEach(t=>{t.dataset.tab===e?t.classList.add("active"):t.classList.remove("active")});this.container.querySelectorAll(".demo-panel").forEach(t=>{t.id===`${e}Demo`?t.classList.add("active"):t.classList.remove("active")})}showEncodingDemo(e){return r(this,null,function*(){if(!this.container||!e)return;const t=y.generateEncodingDemo(e),n=this.container.querySelector("#encodingSteps");n&&(this.currentDemo={type:"encoding",text:e,steps:t},yield this.renderSteps(n,t,"encoding"),this.updateStatus(`编码演示：${e} → ${t.length}个步骤`))})}showDecodingDemo(e){return r(this,null,function*(){if(!this.container||!e)return;const t=y.generateDecodingDemo(e),n=this.container.querySelector("#decodingSteps");n&&(this.currentDemo={type:"decoding",text:e,steps:t},yield this.renderSteps(n,t,"decoding"),this.updateStatus(`解码演示：${e.substring(0,20)}... → ${t.length}个步骤`))})}renderSteps(e,t,n){return r(this,null,function*(){if(e){e.innerHTML="";for(let n=0;n<t.length;n++){const i=t[n],s=this.createStepElement(i,n);e.appendChild(s)}}})}createStepElement(e,t){const n=document.createElement("div");n.className="demo-step",n.dataset.step=e.step;const i=0===e.step;return i&&n.classList.add("error"),n.innerHTML=`\n            <div class="step-header">\n                <div class="step-number">${i?"⚠️":e.step}</div>\n                <div class="step-title">\n                    <h4>${e.title}</h4>\n                    <p class="step-description">${e.description}</p>\n                </div>\n            </div>\n            \n            <div class="step-content">\n                <div class="step-io">\n                    <div class="step-input">\n                        <label>${d.t("demo.input")}:</label>\n                        <div class="step-data${e.step>2?" cipher-display":""}">${this.escapeHtml(e.input)}</div>\n                    </div>\n                    \n                    <div class="step-arrow">→</div>\n                    \n                    <div class="step-output">\n                        <label>${d.t("demo.output")}:</label>\n                        <div class="step-data${e.step>2?" cipher-display":""}">${this.escapeHtml(e.output)}</div>\n                    </div>\n                </div>\n                \n                ${e.technical?`\n                    <div class="step-technical">\n                        <details>\n                            <summary>${d.t("demo.technical")}</summary>\n                            <div class="technical-details">${this.escapeHtml(e.technical)}</div>\n                        </details>\n                    </div>\n                `:""}\n            </div>\n        `,n}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}updateStatus(e){var t;const n=null==(t=this.container)?void 0:t.querySelector("#demoStatus");n&&(n.textContent=e)}highlightStep(e){if(!this.container)return;this.container.querySelectorAll(".demo-step").forEach(t=>{parseInt(t.dataset.step)===e&&(t.classList.add("highlighted"),t.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{t.classList.remove("highlighted")},3e3))})}exportDemo(){return this.currentDemo?(e=((e,t)=>{for(var n in t||(t={}))s.call(t,n)&&o(e,n,t[n]);if(i)for(var n of i(t))a.call(t,n)&&o(e,n,t[n]);return e})({},this.currentDemo),r={timestamp:(new Date).toISOString(),version:"1.0"},t(e,n(r))):null;var e,r}generateReport(){if(!this.currentDemo)return"<p>没有可用的演示数据</p>";const{type:e,text:t,steps:n}=this.currentDemo;let i=`\n            <div class="demo-report">\n                <h3>oi1 ${"encoding"===e?"编码":"解码"}演示报告</h3>\n                <p><strong>输入文本：</strong> ${this.escapeHtml(t)}</p>\n                <p><strong>步骤数量：</strong> ${n.length}</p>\n                <p><strong>生成时间：</strong> ${(new Date).toLocaleString()}</p>\n                \n                <div class="report-steps">\n        `;return n.forEach(e=>{i+=`\n                <div class="report-step">\n                    <h4>步骤 ${e.step}: ${e.title}</h4>\n                    <p>${e.description}</p>\n                    <div class="report-step-data">\n                        <p><strong>输入：</strong> <code>${this.escapeHtml(e.input)}</code></p>\n                        <p><strong>输出：</strong> <code>${this.escapeHtml(e.output)}</code></p>\n                        ${e.technical?`<p><strong>技术详情：</strong> ${this.escapeHtml(e.technical)}</p>`:""}\n                    </div>\n                </div>\n            `}),i+="\n                </div>\n            </div>\n        ",i}clear(){if(!this.container)return;const e=this.container.querySelector("#encodingSteps"),t=this.container.querySelector("#decodingSteps");e&&(e.innerHTML=""),t&&(t.innerHTML=""),this.currentDemo=null,this.updateStatus("演示已清空")}destroy(){this.container&&(this.container.innerHTML=""),this.container=null,this.currentDemo=null,this.isInitialized=!1}}class f{constructor(){this.modal=null,this.isInitialized=!1,this.isVisible=!1}init(){return r(this,null,function*(){this.isInitialized||(this.createModal(),this.bindEvents(),this.isInitialized=!0)})}createModal(){this.modal=document.getElementById("helpModal"),this.modal||(this.modal=document.createElement("div"),this.modal.id="helpModal",this.modal.className="modal",document.body.appendChild(this.modal)),this.modal.innerHTML=`\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3 data-i18n="help.title">oi1 算法原理</h3>\n                    <button id="closeModal" class="modal-close">&times;</button>\n                </div>\n                <div class="modal-body">\n                    ${this.generateHelpContent()}\n                </div>\n            </div>\n        `,d.applyLanguage()}generateHelpContent(){const e=this.generateSimilaritySection(),t=this.generateMappingTable(),n=this.generateProcessFlow(),i=this.generateExampleDemo(),s=this.generateVisualComparison(),a=this.generateSecurityInfo(),o=this.generateTipsSection(),r=this.generateSpecsSection();return`\n            <div class="help-content">\n                \x3c!-- 视觉相似性对比 --\x3e\n                ${e}\n\n                \x3c!-- 字符映射 --\x3e\n                <section class="help-section">\n                    <h4>${d.t("help.mapping.title")}</h4>\n                    <p>${d.t("help.mapping.subtitle")}</p>\n                    ${t}\n                </section>\n\n                \x3c!-- 加密流程 --\x3e\n                ${n}\n\n                \x3c!-- 示例演示 --\x3e\n                ${i}\n\n                \x3c!-- 视觉效果对比 --\x3e\n                ${s}\n\n                \x3c!-- 安全特性 --\x3e\n                ${a}\n\n                \x3c!-- 使用技巧 --\x3e\n                ${o}\n\n                \x3c!-- 技术规格 --\x3e\n                ${r}\n            </div>\n        `}generateSimilaritySection(){var e,t;const n=(null==(t=null==(e=d.currentMessages.help)?void 0:e.similarity)?void 0:t.pairs)||[];return`\n            <section class="help-section">\n                <h4>${d.t("help.similarity.title")}</h4>\n                <div class="visual-similarity">\n                    <div class="char-comparison">\n                        ${n.map(e=>`\n                            <div class="char-pair">\n                                <span class="char-display large">${e.char1}</span>\n                                <span class="vs">vs</span>\n                                <span class="char-display large">${e.char2}</span>\n                                <div class="similarity-note">${e.desc}</div>\n                            </div>\n                        `).join("")}\n                    </div>\n                </div>\n            </section>\n        `}generateProcessFlow(){var e,t;const n=(null==(t=null==(e=d.currentMessages.help)?void 0:e.process)?void 0:t.steps)||[];return`\n            <section class="help-section">\n                <h4>${d.t("help.process.title")}</h4>\n                <div class="flow-diagram">\n                    ${n.map((e,t)=>`\n                        <div class="flow-step ${"✓"===e.number?"final":""}">\n                            <div class="flow-number">${e.number}</div>\n                            <div class="flow-content">\n                                <strong>${e.title}</strong>\n                                <p>${e.desc}</p>\n                            </div>\n                        </div>\n                        ${t<n.length-1?'<div class="flow-arrow">↓</div>':""}\n                    `).join("")}\n                </div>\n            </section>\n        `}generateVisualComparison(){return`\n            <section class="help-section">\n                <h4>${d.t("help.visual.title")}</h4>\n                <div class="visual-comparison">\n                    <div class="comparison-item">\n                        <span class="comparison-label">${d.t("help.visual.normal").split(":")[0]}：</span>\n                        <span class="comparison-value">${d.t("help.visual.normal").split(":")[1]}</span>\n                    </div>\n                    <div class="comparison-item">\n                        <span class="comparison-label">${d.t("help.visual.mono").split(":")[0]}：</span>\n                        <span class="comparison-value cipher-display">${d.t("help.visual.mono").split(":")[1]}</span>\n                    </div>\n                </div>\n            </section>\n        `}generateTipsSection(){var e,t;const n=(null==(t=null==(e=d.currentMessages.help)?void 0:e.tips)?void 0:t.items)||[];return`\n            <section class="help-section">\n                <h4>${d.t("help.tips.title")}</h4>\n                <div class="tips-list">\n                    ${n.map(e=>`\n                        <div class="tip-item">\n                            <span class="tip-icon">${e.icon}</span>\n                            <div class="tip-content">\n                                <strong>${e.title}：</strong>\n                                <p>${e.desc}</p>\n                            </div>\n                        </div>\n                    `).join("")}\n                </div>\n            </section>\n        `}generateSpecsSection(){var e,t;const n=(null==(t=null==(e=d.currentMessages.help)?void 0:e.specs)?void 0:t.items)||[];return`\n            <section class="help-section">\n                <h4>${d.t("help.specs.title")}</h4>\n                <div class="tech-specs">\n                    ${n.map(e=>`\n                        <div class="spec-row">\n                            <span class="spec-label">${e.label}：</span>\n                            <span class="spec-value">${e.value}</span>\n                        </div>\n                    `).join("")}\n                </div>\n            </section>\n        `}generateMappingTable(){var e,t;return`\n            <div class="mapping-table">\n                <table>\n                    <thead>\n                        <tr>\n                            <th>二进制</th>\n                            <th>字符</th>\n                            <th>描述</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        ${((null==(t=null==(e=d.currentMessages.help)?void 0:e.mapping)?void 0:t.table)||[]).map(e=>`\n                            <tr>\n                                <td><code>${e.binary}</code></td>\n                                <td><span class="char-display">${e.char}</span></td>\n                                <td>${e.desc}</td>\n                            </tr>\n                        `).join("")}\n                    </tbody>\n                </table>\n            </div>\n        `}generateExampleDemo(){var e,t;const n=null==(e=d.currentMessages.help)?void 0:e.example;return n?`\n            <section class="help-section">\n                <h4>${n.title}</h4>\n                <div class="example-demo">\n                    <div class="example-item">\n                        <h5>${n.subtitle}</h5>\n                        <div class="example-steps">\n                            ${(null==(t=n.steps)?void 0:t.map(e=>`\n                                <div class="example-step">\n                                    <span class="step-label">${e.label}</span>\n                                    <span class="step-value ${"密文："===e.label?"cipher-display":""}">${e.value}</span>\n                                </div>\n                            `).join(""))||""}\n                        </div>\n                    </div>\n                </div>\n            </section>\n        `:""}generateSecurityInfo(){var e,t;const n=null==(e=d.currentMessages.help)?void 0:e.security;return n?`\n            <section class="help-section">\n                <h4>${n.title}</h4>\n                <div class="security-info">\n                    ${(null==(t=n.features)?void 0:t.map(e=>`\n                        <div class="security-feature">\n                            <span class="security-icon">${e.icon}</span>\n                            <div class="security-content">\n                                <strong>${e.title}：</strong>\n                                <p>${e.desc}</p>\n                            </div>\n                        </div>\n                    `).join(""))||""}\n                    \n                    ${n.warning?`\n                        <div class="security-note">\n                            <strong>注意：</strong> ${n.warning}\n                        </div>\n                    `:""}\n                </div>\n            </section>\n        `:""}bindEvents(){if(!this.modal)return;const e=this.modal.querySelector("#closeModal");e&&e.addEventListener("click",()=>this.hide()),this.modal.addEventListener("click",e=>{e.target===this.modal&&this.hide()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.isVisible&&this.hide()}),window.addEventListener("languageChange",()=>{this.isVisible&&this.updateContent()})}show(){if(!this.modal)return;this.modal.style.display="flex",this.isVisible=!0,document.body.style.overflow="hidden";const e=this.modal.querySelector("#closeModal");e&&e.focus()}hide(){this.modal&&(this.modal.style.display="none",this.isVisible=!1,document.body.style.overflow="")}toggle(){this.isVisible?this.hide():this.show()}updateContent(){if(!this.modal)return;const e=this.modal.querySelector(".modal-body");e&&(e.innerHTML=this.generateHelpContent()),d.applyLanguage()}destroy(){this.modal&&this.modal.parentNode&&this.modal.parentNode.removeChild(this.modal),this.modal=null,this.isInitialized=!1,this.isVisible=!1,document.body.style.overflow=""}}(new class{constructor(){this.encoder=new g,this.decoder=new m,this.clipboard=new v,this.demoViewer=new b,this.helpModal=new f,this.elements={},this.isInitialized=!1,this.handleEncode=this.handleEncode.bind(this),this.handleDecode=this.handleDecode.bind(this),this.handleLanguageChange=this.handleLanguageChange.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleCipherInputChange=this.handleCipherInputChange.bind(this)}init(){return r(this,null,function*(){if(!this.isInitialized)try{"loading"===document.readyState&&(yield new Promise(e=>{document.addEventListener("DOMContentLoaded",e)})),this.initElements(),this.bindEventListeners(),yield this.initComponents(),this.applyInitialState(),this.isInitialized=!0,console.log("oi1 App initialized successfully")}catch(e){console.error("Failed to initialize oi1 App:",e),this.showError("应用程序初始化失败",e.message)}})}initElements(){this.elements.plaintext=document.getElementById("plaintext"),this.elements.ciphertext=document.getElementById("ciphertext"),this.elements.cipherInput=document.getElementById("cipherInput"),this.elements.plaintextOutput=document.getElementById("plaintextOutput"),this.elements.encodeBtn=document.getElementById("encodeBtn"),this.elements.decodeBtn=document.getElementById("decodeBtn"),this.elements.clearPlainBtn=document.getElementById("clearPlainBtn"),this.elements.clearCipherBtn=document.getElementById("clearCipherBtn"),this.elements.copyCipherBtn=document.getElementById("copyCipherBtn"),this.elements.copyPlainBtn=document.getElementById("copyPlainBtn"),this.elements.pasteBtn=document.getElementById("pasteBtn"),this.elements.helpBtn=document.getElementById("helpBtn"),this.elements.languageSelect=document.getElementById("languageSelect"),this.elements.plaintextCount=document.getElementById("plaintextCount"),this.elements.ciphertextCount=document.getElementById("ciphertextCount"),this.elements.cipherInputCount=document.getElementById("cipherInputCount"),this.elements.plaintextOutputCount=document.getElementById("plaintextOutputCount"),this.elements.validationStatus=document.getElementById("validationStatus"),this.elements.errorMessage=document.getElementById("errorMessage"),this.elements.toggleDemo=document.getElementById("toggleDemo"),this.elements.demoContent=document.getElementById("demoContent");const e=["plaintext","ciphertext","cipherInput","plaintextOutput","encodeBtn","decodeBtn","languageSelect"];for(const t of e)if(!this.elements[t])throw new Error(`Required element not found: ${t}`)}bindEventListeners(){this.elements.encodeBtn.addEventListener("click",this.handleEncode),this.elements.decodeBtn.addEventListener("click",this.handleDecode),this.elements.clearPlainBtn.addEventListener("click",()=>this.clearInput("plaintext")),this.elements.clearCipherBtn.addEventListener("click",()=>this.clearInput("cipherInput")),this.elements.copyCipherBtn.addEventListener("click",()=>this.copyText("ciphertext")),this.elements.copyPlainBtn.addEventListener("click",()=>this.copyText("plaintextOutput")),this.elements.pasteBtn.addEventListener("click",()=>this.pasteText("cipherInput")),this.elements.helpBtn.addEventListener("click",()=>this.helpModal.show()),this.elements.languageSelect.addEventListener("change",this.handleLanguageChange),this.elements.plaintext.addEventListener("input",this.handleInputChange),this.elements.cipherInput.addEventListener("input",this.handleCipherInputChange),this.elements.toggleDemo&&this.elements.toggleDemo.addEventListener("click",()=>this.toggleDemo()),document.addEventListener("keydown",e=>this.handleKeyboardShortcuts(e)),window.addEventListener("languageChange",()=>this.onLanguageChanged())}initComponents(){return r(this,null,function*(){yield this.demoViewer.init(this.elements.demoContent),yield this.helpModal.init(),this.updateLanguageSelector()})}applyInitialState(){this.updateCharCount("plaintext"),this.updateCharCount("ciphertext"),this.updateCharCount("cipherInput"),this.updateCharCount("plaintextOutput"),this.updateButtonStates()}handleEncode(){return r(this,null,function*(){try{const e=this.elements.plaintext.value;if(!e.trim())return void this.showMessage(d.t("messages.invalidInput"),"warning");this.setButtonLoading(this.elements.encodeBtn,!0);const t=this.encoder.encode(e);this.elements.ciphertext.value=t,this.updateCharCount("ciphertext"),this.showEncodingStats(e,t),this.demoViewer.showEncodingDemo(e),this.showMessage(d.t("messages.encodeSuccess"),"success")}catch(e){console.error("Encoding error:",e),this.showError(d.t("messages.encodeError"),e.message)}finally{this.setButtonLoading(this.elements.encodeBtn,!1)}})}handleDecode(){return r(this,null,function*(){try{const e=this.elements.cipherInput.value;if(!e.trim())return void this.showMessage(d.t("messages.invalidInput"),"warning");this.setButtonLoading(this.elements.decodeBtn,!0);const t=this.decoder.decode(e);this.elements.plaintextOutput.value=t,this.updateCharCount("plaintextOutput"),this.demoViewer.showDecodingDemo(e),this.showMessage(d.t("messages.decodeSuccess"),"success")}catch(e){console.error("Decoding error:",e),this.showError(d.t("messages.decodeError"),e.message)}finally{this.setButtonLoading(this.elements.decodeBtn,!1)}})}handleLanguageChange(){const e=this.elements.languageSelect.value;d.setLanguage(e)}handleInputChange(){this.updateCharCount("plaintext"),this.updateButtonStates(),this.elements.plaintext.value.length>0&&this.elements.plaintext.value.length<100&&this.debouncedPreview()}handleCipherInputChange(){this.updateCharCount("cipherInput"),this.validateCipherInput(),this.updateButtonStates()}validateCipherInput(){const e=this.elements.cipherInput.value;if(!e)return void this.updateValidationStatus("","none");const t=this.decoder.validateCiphertext(e);t.isValid?this.updateValidationStatus(d.t("validation.valid"),"valid"):this.updateValidationStatus(t.error,"invalid")}updateValidationStatus(e,t){this.elements.validationStatus&&(this.elements.validationStatus.textContent=e,this.elements.validationStatus.className=`validation-status ${t}`,"none"===t&&(this.elements.validationStatus.className="validation-status"))}updateCharCount(e){const t=this.elements[e],n=this.elements[e+"Count"];if(t&&n){const e=t.value.length;n.textContent=e}}updateButtonStates(){const e=this.elements.plaintext.value.trim().length>0;this.elements.encodeBtn.disabled=!e;const t=this.elements.cipherInput.value.trim().length>0,n=this.decoder.validateCiphertext(this.elements.cipherInput.value).isValid;this.elements.decodeBtn.disabled=!t||!n,this.elements.copyCipherBtn.disabled=0===this.elements.ciphertext.value.length,this.elements.copyPlainBtn.disabled=0===this.elements.plaintextOutput.value.length}setButtonLoading(e,t){if(t){e.disabled=!0,e.classList.add("loading");const t=e.textContent;e.dataset.originalText=t,e.textContent="..."}else e.disabled=!1,e.classList.remove("loading"),e.dataset.originalText&&(e.textContent=e.dataset.originalText,delete e.dataset.originalText)}clearInput(e){const t=this.elements[e];t&&(t.value="",this.updateCharCount(e),this.updateButtonStates(),"cipherInput"===e&&this.updateValidationStatus("","none"),this.showMessage(d.t("messages.clearSuccess"),"info"))}copyText(e){return r(this,null,function*(){const t=this.elements[e];if(t&&t.value)try{yield this.clipboard.copy(t.value),this.showMessage(d.t("messages.copySuccess"),"success");const n="ciphertext"===e?this.elements.copyCipherBtn:this.elements.copyPlainBtn;this.highlightButton(n)}catch(n){console.error("Copy failed:",n),this.showMessage(d.t("messages.copyError"),"error")}})}pasteText(e){return r(this,null,function*(){try{const t=yield this.clipboard.paste(),n=this.elements[e];n&&t&&(n.value=t,this.updateCharCount(e),this.updateButtonStates(),"cipherInput"===e&&this.validateCipherInput(),this.showMessage(d.t("messages.pasteSuccess"),"success"))}catch(t){console.error("Paste failed:",t),this.showMessage(d.t("messages.pasteError"),"error")}})}highlightButton(e){e.classList.add("highlighted"),setTimeout(()=>{e.classList.remove("highlighted")},200)}toggleDemo(){"none"!==this.elements.demoContent.style.display?(this.elements.demoContent.style.display="none",this.elements.toggleDemo.textContent=d.t("ui.expand")):(this.elements.demoContent.style.display="block",this.elements.toggleDemo.textContent=d.t("ui.collapse"))}showEncodingStats(e,t){const n=this.encoder.getEncodingStats(e,t);console.log("Encoding stats:",n)}handleKeyboardShortcuts(e){(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&(document.activeElement===this.elements.plaintext?(this.handleEncode(),e.preventDefault()):document.activeElement===this.elements.cipherInput&&(this.handleDecode(),e.preventDefault())),(e.ctrlKey||e.metaKey)&&"k"===e.key&&(document.activeElement===this.elements.plaintext?this.clearInput("plaintext"):document.activeElement===this.elements.cipherInput&&this.clearInput("cipherInput"),e.preventDefault())}onLanguageChanged(){this.updateButtonStates(),this.validateCipherInput()}updateLanguageSelector(){this.elements.languageSelect.value=d.getCurrentLanguage()}debouncedPreview(){this.previewTimeout&&clearTimeout(this.previewTimeout),this.previewTimeout=setTimeout(()=>{},300)}showMessage(e,t="info",n=3e3){let i=document.getElementById("messageToast");i||(i=document.createElement("div"),i.id="messageToast",i.className="message-toast",document.body.appendChild(i)),i.textContent=e,i.className=`message-toast ${t} show`,this.messageTimeout&&clearTimeout(this.messageTimeout),this.messageTimeout=setTimeout(()=>{i.classList.remove("show")},n)}showError(e,t){const n=this.elements.errorMessage;n&&(n.innerHTML=`<strong>${e}</strong><br>${t}`,n.style.display="block",setTimeout(()=>{n.style.display="none"},5e3)),console.error(`${e}:`,t)}}).init().catch(e=>{console.error("Failed to start application:",e)});
